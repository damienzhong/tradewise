<!DOCTYPE html>
<html lang="zh-CN" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>登录日志 - TradeWise</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; background: #f5f7fa; }
        .container { margin-left: 250px; padding: 32px; }
        .card { background: white; padding: 24px; border-radius: 12px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); }
        table { width: 100%; border-collapse: collapse; }
        th, td { padding: 12px; text-align: left; border-bottom: 1px solid #f0f0f0; }
        th { background: #f5f7fa; font-weight: 600; color: #666; }
        .badge { padding: 4px 8px; border-radius: 4px; font-size: 12px; font-weight: 500; }
        .badge-success { background: #d4edda; color: #155724; }
        .badge-failed { background: #f8d7da; color: #721c24; }
    </style>
</head>
<body data-page="login-logs">
    <div th:replace="user/components/tw-user-sidebar :: ~{}"></div>
    
    <div class="container">
        <h1 style="margin-bottom: 24px; color: #333;">登录日志</h1>
        <div class="card">
            <table>
                <thead>
                    <tr>
                        <th>登录时间</th>
                        <th>登录IP</th>
                        <th>浏览器</th>
                        <th>状态</th>
                        <th>失败原因</th>
                    </tr>
                </thead>
                <tbody id="logTable"></tbody>
            </table>
        </div>
    </div>
    
    <script>
        async function loadLogs() {
            const response = await fetch('/user/login-logs/my');
            const result = await response.json();
            
            if (result.success) {
                const tbody = document.getElementById('logTable');
                tbody.innerHTML = result.data.map(log => `
                    <tr>
                        <td>${new Date(log.loginTime).toLocaleString()}</td>
                        <td>${log.loginIp || '-'}</td>
                        <td style="max-width: 300px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;">${log.userAgent || '-'}</td>
                        <td><span class="badge ${log.loginStatus === 'SUCCESS' ? 'badge-success' : 'badge-failed'}">${log.loginStatus === 'SUCCESS' ? '成功' : '失败'}</span></td>
                        <td>${log.failReason || '-'}</td>
                    </tr>
                `).join('');
            }
        }
        
        loadLogs();
    </script>
</body>
</html>
